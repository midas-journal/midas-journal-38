This code would clearly benefit from:

1) Swath merit-function caching, to avoid recomputing the same value multiple times in many cases.

2) Better automated path ligation on the final result, to remove spurious parts of the path.
